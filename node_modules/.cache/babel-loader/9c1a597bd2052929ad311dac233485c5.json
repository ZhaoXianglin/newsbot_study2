{"remainingRequest":"/Users/xianglin/WebstormProjects/PhoneBot/node_modules/babel-loader/lib/index.js!/Users/xianglin/WebstormProjects/PhoneBot/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/xianglin/WebstormProjects/PhoneBot/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xianglin/WebstormProjects/PhoneBot/src/views/Assistant.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xianglin/WebstormProjects/PhoneBot/src/views/Assistant.vue","mtime":1661675314180},{"path":"/Users/xianglin/WebstormProjects/PhoneBot/babel.config.js","mtime":1658830931000},{"path":"/Users/xianglin/WebstormProjects/PhoneBot/node_modules/cache-loader/dist/cjs.js","mtime":1658830951000},{"path":"/Users/xianglin/WebstormProjects/PhoneBot/node_modules/babel-loader/lib/index.js","mtime":1658830952000},{"path":"/Users/xianglin/WebstormProjects/PhoneBot/node_modules/cache-loader/dist/cjs.js","mtime":1658830951000},{"path":"/Users/xianglin/WebstormProjects/PhoneBot/node_modules/vue-loader/lib/index.js","mtime":1658830954000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEJvdFVpIGZyb20gIi4uL2NvbXBvbmVudHMvQm90VWkiOyAvLyDlr7nosaHlvJXlhaUKCmltcG9ydCB7IGJvdHVpIH0gZnJvbSAnQC9jb21wb25lbnRzL0JvdFVpJzsKaW1wb3J0IHsgaW5zdGFuY2UgfSBmcm9tICJAL3JlcXVlc3QiOwppbXBvcnQgeyBzdG9yZSB9IGZyb20gIkAvc3RvcmUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkFzc2lzdGFudCIsCiAgY29tcG9uZW50czogewogICAgQm90VWk6IEJvdFVpCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy/lrp7pqozmnaHku7YKICAgICAgaWRlbnRpdHlfY3VlOiAiIiwKICAgICAgZXhwbGFuYXRpb25fc3R5bGU6ICIiLAogICAgICAvL+aOp+WItuWKn+iDvQogICAgICAvL+aYr+WQpuWxleekuui/h+i+k+WFpeaPkOekuuOAggogICAgICAvLyDop6Pph4rlsZXnpLrnmoTmlbDph48KICAgICAgZXhwX2NvdW50OiAwLAogICAgICBleHBsYW5hdGlvbl9zdHlwbGVfY29udHJvbDogJ2V4cGxhbmF0aW9uJywKICAgICAgY2FuX3Nob3dfZW50ZXJfdGlwczogdHJ1ZSwKICAgICAgc2hvd19lcnJfcmVtaW5kZXI6IGZhbHNlLAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgbXNnX2J0bl9jdHJsOiB0cnVlLAogICAgICBzaG93X2hlbHA6IHRydWUsCiAgICAgIHNob3dfcmF0ZTogZmFsc2UsCiAgICAgIHNob3dfcHJlZmVyZW5jZTogZmFsc2UsCiAgICAgIHNob3dfbmV4dF9wYWdlOiBmYWxzZSwKICAgICAgaGVscF9zaG93ZWRfY291bnQ6IDEsCiAgICAgIHNob3dfY2FydDogZmFsc2UsCiAgICAgIHNob3dfcGhvbmVfcGFnZTogZmFsc2UsCiAgICAgIHBob25lX2J1dHRvbnM6IFt7CiAgICAgICAgdGV4dDogJ0FkZCB0byBjYXJ0JywKICAgICAgICB2YWx1ZTogJ0FkZCB0byBjYXJ0JwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ05leHQgaXRlbScsCiAgICAgICAgdmFsdWU6ICdOZXh0IGl0ZW0nCiAgICAgIH1dLAogICAgICAvL2N1cnJlbnQgYWN0aW9uCiAgICAgIC8v5pWw5o2u6YOo5YiGCiAgICAgIHV1aWQ6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1dWlkIiksCiAgICAgIC8vdXVpZDogJ2UzNGNkZGM0YTdhZTQ3YmI5ZjdiYWRmOWU0NGNmNDFlJywKICAgICAgY2xpY2tlZF90cmFuc191cmw6ICIiLAogICAgICBtZXNzYWdlOiAiIiwKICAgICAgdXNlcl9wcmVmZXI6IHsKICAgICAgICBicmFuZDogJycsCiAgICAgICAgYnVkZ2V0OiA3MDAsCiAgICAgICAgZGlzcGxheV9zaXplOiAnJywKICAgICAgICBiYXR0ZXJ5OiAnJywKICAgICAgICB3ZWlnaHQ6ICcnCiAgICAgIH0sCiAgICAgIHBob25lX2luX2NhcnQ6IFtdLAogICAgICBjdXJyZW50X3Bob25lOiB7fSwKICAgICAgbGF0ZXN0X2RpYWxvZzogW10sCiAgICAgIC8vbG9nCiAgICAgIGxvZzogW10sCiAgICAgIC8v5pyA5ZCO5LiA5qyh55qE5Yqo5L2cCiAgICAgIGxhc3RfYWN0aW9uOiAiIiwKICAgICAgLy/nlKjmiLfnmoTlkI3lrZcKICAgICAgdXNlcm5hbWU6ICIiLAogICAgICBib3RfbXNnOiBbJ0kgZmluZCB0aGlzIHBob25lIGZvciB5b3UuJywgJ1lvdSBtYXkgbGlrZSB0aGlzIHBob25lLicsICdQbGVhc2UgY2hlY2sgdGhpcyBwaG9uZS4nXQogICAgfTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLmV4cGxhbmF0aW9uX3N0eWxlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImV4cGxhbmF0aW9uX3N0eWxlIik7CiAgICB0aGlzLmlkZW50aXR5X2N1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpZGVudGl0eV9jdWUiKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8v5LuO5Y2h54mH57uE5Lu26YeM6Z2i6I635b6X54K55Ye75LqL5Lu255qEdXJsCiAgICBjbGlja2VkX3VybDogZnVuY3Rpb24gY2xpY2tlZF91cmwoY2hpbGRWYWx1ZSkgewogICAgICB0aGlzLmNsaWNrZWRfdHJhbnNfdXJsID0gImh0dHBzOi8vd3d3LmNoYXRib3QuZmFuczozMDAwLz91cmw9IiArIGNoaWxkVmFsdWU7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2xpY2tlZF90cmFuc191cmwpOwogICAgICB0aGlzLnNob3dfcGhvbmVfcGFnZSA9IHRydWU7CiAgICB9LAogICAgLy/mt7vliqDml6Xlv5fmiZPngrkKICAgIGFkZExvZzogZnVuY3Rpb24gYWRkTG9nKHR5cGUsIGFjdGlvbk5hbWUsIGNvbnRlbnQpIHsKICAgICAgdmFyIGxvZ3RpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgdmFyIGxvZyA9IHsKICAgICAgICAndHlwZSc6IHR5cGUsCiAgICAgICAgJ2FjdGlvbic6IGFjdGlvbk5hbWUsCiAgICAgICAgJ2NvbnRlbnQnOiBjb250ZW50LAogICAgICAgICdsb2d0aW1lJzogbG9ndGltZQogICAgICB9OwogICAgICB0aGlzLmxvZy5wdXNoKGxvZyk7CiAgICB9LAogICAgLy/pu5jorqTlr7nor50KICAgIGJvdDogZnVuY3Rpb24gYm90KG1zZykgewogICAgICB2YXIgc3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICIiOwogICAgICB2YXIgY29uZmlnID0gewogICAgICAgIHR5cGU6ICdodG1sJywKICAgICAgICBjc3NDbGFzczogc3R5bGUsCiAgICAgICAgbG9hZGluZzogdHJ1ZSwKICAgICAgICBkZWxheTogMTAsCiAgICAgICAgcGhvdG86ICJodHRwczovL211c2ljYm90LTEyNTEwNTI1MzUuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9waG9uZWJvdC9hdmF0YXIxLnBuZyIsCiAgICAgICAgY29udGVudDogbXNnCiAgICAgIH07CgogICAgICBpZiAodGhpcy5pZGVudGl0eV9jdWUgPT09ICcxJykgewogICAgICAgIGNvbmZpZy5waG90byA9ICJodHRwczovL211c2ljYm90LTEyNTEwNTI1MzUuY29zLmFwLXNoYW5naGFpLm15cWNsb3VkLmNvbS9waG9uZWJvdC9hdmF0YXIyLnBuZyI7CiAgICAgICAgY29uZmlnLmRlbGF5ID0gbXNnLmxlbmd0aCAqIDQwOwogICAgICB9CgogICAgICB0aGlzLmFkZExvZygnYm90JywgdGhpcy5sYXN0X2FjdGlvbiwgbXNnKTsKICAgICAgcmV0dXJuIGJvdHVpLm1lc3NhZ2UuYm90KGNvbmZpZyk7CiAgICB9LAogICAgaHVtYW46IGZ1bmN0aW9uIGh1bWFuKG1zZykgewogICAgICB0aGlzLmFkZExvZygnaHVtYW4nLCB0aGlzLmxhc3RfYWN0aW9uLCBtc2cpOwogICAgICByZXR1cm4gYm90dWkubWVzc2FnZS5odW1hbih7CiAgICAgICAgY29udGVudDogbXNnCiAgICAgIH0pOwogICAgfSwKICAgIC8v5ZWG5ZOB5Y2h54mHCiAgICBib3RQaG9uZUNhcmQ6IGZ1bmN0aW9uIGJvdFBob25lQ2FyZChwaG9uZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICB0eXBlOiAncGhvbmUnLAogICAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgICAgZGVsYXk6IDEwMCwKICAgICAgICBjb250ZW50OiBwaG9uZQogICAgICB9OwoKICAgICAgaWYgKHRoaXMuaWRlbnRpdHlfY3VlID09PSAnMScpIHsKICAgICAgICBjb25maWcucGhvdG8gPSAiaHR0cHM6Ly9tdXNpY2JvdC0xMjUxMDUyNTM1LmNvcy5hcC1zaGFuZ2hhaS5teXFjbG91ZC5jb20vcGhvbmVib3QvYXZhdGFyMi5wbmciOwogICAgICAgIGNvbmZpZy5kZWxheSA9IDE2MDA7CiAgICAgIH0KCiAgICAgIHRoaXMuYWRkTG9nKCdib3QnLCAncGhvbmVjYXJkJywgcGhvbmUuaWQgKyAnfCcgKyBwaG9uZS5tb2RlbG5hbWUpOwogICAgICBib3R1aS5tZXNzYWdlLmJvdChjb25maWcpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKGJvdHVpKTsKICAgICAgICBib3R1aS5hY3Rpb24uYnV0dG9uKHsKICAgICAgICAgIGFkZE1lc3NhZ2U6IGZhbHNlLAogICAgICAgICAgaHVtYW46IGZhbHNlLAogICAgICAgICAgYWN0aW9uOiBfdGhpcy5waG9uZV9idXR0b25zCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAvL+WIpOaWreeCueS6huS7gOS5iOaMiemSrgogICAgICAgICAgaWYgKHJlcy50ZXh0ID09PSAnQWRkIHRvIGNhcnQnKSB7CiAgICAgICAgICAgIGlmIChfdGhpcy5jaGVja0JlZm9yZVRvQ2FydCgpKSB7CiAgICAgICAgICAgICAgX3RoaXMuYWRkVG9DYXJ0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy/mj5DnpLrlvZPliY3nmoTmiYvmnLrmmK/mnInov4fmj5DphpLnmoQKICAgICAgICAgICAgICBzdG9yZS5zZXRXYXJuaW5nKCk7CiAgICAgICAgICAgICAgX3RoaXMuc2hvd19lcnJfcmVtaW5kZXIgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJlcy50ZXh0ID09PSAnTmV4dCBpdGVtJykgewogICAgICAgICAgICBfdGhpcy50cnlBbm90aGVyKCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJlcy50ZXh0ID09PSAnTGV0IGJvdCBzdWdnZXN0JykgewogICAgICAgICAgICBfdGhpcy5sZXRCb3RTdWdnZXN0KCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOaPkOekuuWPr+S7pei+k+WFpQogICAgZW50ZXJfdGlwczogZnVuY3Rpb24gZW50ZXJfdGlwcygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmxhc3RfYWN0aW9uID0gJ2VudGVyX3RpcHMnOwogICAgICB0aGlzLmJvdCgiSWYgeW91IGFyZSBub3Qgc2F0aXNmaWVkIHdpdGggY3VycmVudCByZWNvbW1lbmRhdGlvbnMsIHlvdSBjYW4gbW9kaWZ5IHlvdXIgcmVxdWlyZW1lbnQgYnkgdHlwaW5nIGluIHRoZSBpbnB1dCBmaWVsZC4iKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIuYm90KCJGb3IgZXhhbXBsZSwgeW91IGNvdWxkIHNheToiKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuYm90KCJcIkkgbmVlZCBhIChzbWFsbCAvIG1lZGl1bSAvIGxhcmdlKSBkaXNwbGF5XCIiKTsKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuYm90KCJcIkkgbmVlZCBhIHBob25lIHdpdGggKGxvdyAvIG1lZGl1bSAvIGhpZ2gpIGJhdHRlcnkgY2FwYWNpdHlcIiIpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgYm90dWkuYWN0aW9uLmJ1dHRvbih7CiAgICAgICAgICAgIGFkZE1lc3NhZ2U6IGZhbHNlLAogICAgICAgICAgICBodW1hbjogdHJ1ZSwKICAgICAgICAgICAgYWN0aW9uOiBbewogICAgICAgICAgICAgIHRleHQ6ICdOZXh0IHJlY29tbWVuZGF0aW9uJywKICAgICAgICAgICAgICB2YWx1ZTogJ25leHQnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICB0ZXh0OiAnTW9kaWZ5IG15IHJlcXVpcmVtZW50JywKICAgICAgICAgICAgICB2YWx1ZTogJ21vZGlmeScKICAgICAgICAgICAgfV0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAvL+WGjeS5n+S4jeaYvuekuui/meS4quaPkOekuuS6hgogICAgICAgICAgICBfdGhpczIuY2FuX3Nob3dfZW50ZXJfdGlwcyA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHJlcy52YWx1ZSA9PT0gJ25leHQnKSB7CiAgICAgICAgICAgICAgX3RoaXMyLnRyeUFub3RoZXIoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBfdGhpczIuaHVtYW4oIk1vZGlmeSBteSByZXF1aXJlbWVudCIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMyLmJvdCgiT0ssIHRlbGwgbWUgeW91ciByZXF1aXJlbWVudC4iKS50aGVuKGZ1bmN0aW9uICgpIHt9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8v5Yid5aeL5YyW55So5oi35YGP5aW9CiAgICBzdWJtaXRQcmVmZXJlbmNlOiBmdW5jdGlvbiBzdWJtaXRQcmVmZXJlbmNlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMudXNlcl9wcmVmZXIudXNlcm5hbWUgPSB0aGlzLnVzZXJuYW1lOwogICAgICB0aGlzLnVzZXJfcHJlZmVyLnV1aWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXVpZCcpOwogICAgICB0aGlzLnVzZXJfcHJlZmVyLnByZWZlclQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgdGhpcy51c2VyX3ByZWZlci5leHBsYW5hdGlvbl9zdHlsZSA9IHRoaXMuZXhwbGFuYXRpb25fc3R5bGU7CiAgICAgIGluc3RhbmNlLnBvc3QoJy9jaGF0L3ByZWZlcicsIHRoaXMudXNlcl9wcmVmZXIpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIC8vY29uc29sZS5sb2cocmVzKQogICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXMgPT09IDEpIHsKICAgICAgICAgIF90aGlzMy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICBfdGhpczMuc2hvd19wcmVmZXJlbmNlID0gZmFsc2U7IC8vdGhpcy5jdXJyZW50X3Bob25lID0gcmVzLmRhdGEucGhvbmU7CgogICAgICAgICAgc3RvcmUuYWRkU2hvd2VkUGhvbmUocmVzLmRhdGEucGhvbmUpOyAvL+a3u+WKoOaTjeS9nOiusOW9lQoKICAgICAgICAgIF90aGlzMy5sYXRlc3RfZGlhbG9nLnB1c2goewogICAgICAgICAgICAiYWdlbnQiOiAicm9ib3QiLAogICAgICAgICAgICAiYWN0aW9uIjogIkluaXRpYWxpemUiLAogICAgICAgICAgICAidGltZXN0YW1wIjogbmV3IERhdGUoKS5nZXRUaW1lKCkKICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzMy5ib3QoIk9rLCBJIHNlZSBpdCEiKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMzLmJvdChyZXMuZGF0YS5tc2csIF90aGlzMy5leHBsYW5hdGlvbl9zdHlwbGVfY29udHJvbCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXMzLmV4cF9jb3VudCArPSAxOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0b3JlKTsKCiAgICAgICAgICAgICAgX3RoaXMzLmJvdFBob25lQ2FyZChyZXMuZGF0YS5waG9uZS5pZCk7CgogICAgICAgICAgICAgIF90aGlzMy5tc2dfYnRuX2N0cmwgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMzLmxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICBfdGhpczMuJHRvYXN0KCJQbGVhc2UgcmVhZCBhbmQgYWNjZXB0IHRoZSBpbmZvcm1lZCBjb25zZW50IGZpcnN0LiIpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTsKICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICBfdGhpczMuJHRvYXN0KCJOZXR3b3JrIGVycm9yLCBwbGVhc2UgdHJ5IGFnYWluLiIpOwogICAgICB9KTsKICAgIH0sCiAgICAvL+WPkemAgeeUqOaIt+a2iOaBrwogICAgc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uIHNlbmRNZXNzYWdlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLm1lc3NhZ2UubGVuZ3RoID49IDIpIHsKICAgICAgICAvL+WFiOenu+mZpOaMiemSrgogICAgICAgIGJvdHVpLmFjdGlvbi5oaWRlKCk7IC8v5Y+v5Lul5Y+R6YCBCgogICAgICAgIHRoaXMubXNnX2J0bl9jdHJsID0gdHJ1ZTsKICAgICAgICB0aGlzLmh1bWFuKHRoaXMubWVzc2FnZSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvL+i/memHjOaYr+mXruWQjeWtlwogICAgICAgICAgaWYgKF90aGlzNC5sYXN0X2FjdGlvbiA9PT0gJ2Fza191c2VybmFtZScpIHsKICAgICAgICAgICAgX3RoaXM0LnVzZXJuYW1lID0gX3RoaXM0Lm1lc3NhZ2U7CiAgICAgICAgICAgIF90aGlzNC5tc2dfYnRuX2N0cmwgPSBmYWxzZTsKICAgICAgICAgICAgX3RoaXM0Lm1lc3NhZ2UgPSBudWxsOwoKICAgICAgICAgICAgX3RoaXM0LmFza19wcmVmZXIoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzNC5sYXN0X2FjdGlvbiA9ICdzZW5kTWVzc2FnZSc7CgogICAgICAgICAgICBfdGhpczQubGF0ZXN0X2RpYWxvZy5wdXNoKHsKICAgICAgICAgICAgICAiYWdlbnQiOiAieW91IiwKICAgICAgICAgICAgICAidGV4dCI6IF90aGlzNC5tZXNzYWdlLAogICAgICAgICAgICAgICJtb2RhbGl0eSI6ICJ0eXBpbmciLAogICAgICAgICAgICAgICJhY3Rpb24iOiAiVXNlcl9Dcml0aXF1ZSIsCiAgICAgICAgICAgICAgImNyaXRpcXVlIjogW10sCiAgICAgICAgICAgICAgImNyaXRpcXVlZF9pdGVtIjogX3RoaXM0LmN1cnJlbnRfcGhvbmUuaWQsCiAgICAgICAgICAgICAgInRpbWVzdGFtcCI6IG5ldyBEYXRlKCkuZ2V0VGltZSgpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaW5zdGFuY2UucG9zdCgnL2NoYXQvdXNlck1lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgbXNnVDogbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICAgICAgbWVzc2FnZTogX3RoaXM0Lm1lc3NhZ2UsCiAgICAgICAgICAgICAgZXhwbGFuYXRpb25fc3R5bGU6IF90aGlzNC5leHBsYW5hdGlvbl9zdHlsZSwKICAgICAgICAgICAgICBsb2dnZXI6IF90aGlzNC5sYXRlc3RfZGlhbG9nLAogICAgICAgICAgICAgIHV1aWQ6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1dWlkJykKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICAgIF90aGlzNC5jdXJyZW50X3Bob25lID0gcmVzLmRhdGEucGhvbmU7CiAgICAgICAgICAgICAgc3RvcmUuYWRkU2hvd2VkUGhvbmUocmVzLmRhdGEucGhvbmUpOwogICAgICAgICAgICAgIF90aGlzNC5sYXRlc3RfZGlhbG9nID0gW107CiAgICAgICAgICAgICAgX3RoaXM0LmV4cF9jb3VudCArPSAxOwoKICAgICAgICAgICAgICBpZiAoX3RoaXM0LmlkZW50aXR5X2N1ZSA9PT0gJzEnKSB7CiAgICAgICAgICAgICAgICBfdGhpczQuYm90KCJPaywgSSBzZWUgaXQhIikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNC5ib3QocmVzLmRhdGEubXNnLCBfdGhpczQuZXhwbGFuYXRpb25fc3R5cGxlX2NvbnRyb2wpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNC5ib3RQaG9uZUNhcmQoX3RoaXM0LmN1cnJlbnRfcGhvbmUpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBfdGhpczQuYm90KHJlcy5kYXRhLm1zZywgX3RoaXM0LmV4cGxhbmF0aW9uX3N0eXBsZV9jb250cm9sKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0LmJvdFBob25lQ2FyZChfdGhpczQuY3VycmVudF9waG9uZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzNC5tc2dfYnRuX2N0cmwgPSBmYWxzZTsKICAgICAgICAgICAgICBfdGhpczQubWVzc2FnZSA9IG51bGw7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczQubXNnX2J0bl9jdHJsID0gZmFsc2U7CgogICAgICAgICAgICAgIF90aGlzNC4kdG9hc3QoJ1BsZWFzZSB0cnkgYWdhaW4uJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubXNnX2J0bl9jdHJsID0gZmFsc2U7CiAgICAgICAgdGhpcy4kdG9hc3QoJ1BsZWFzZSBlbnRlciBtb3JlIGluZm9ybWF0aW9uLicpOwogICAgICB9CiAgICB9LAogICAgLy/liqDlhaXotK3nianovabliY3nmoTmo4Dmn6UKICAgIGNoZWNrQmVmb3JlVG9DYXJ0OiBmdW5jdGlvbiBjaGVja0JlZm9yZVRvQ2FydCgpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudF9waG9uZS5iYXR0ZXJ5IDw9IDQwNTApIHJldHVybiBmYWxzZTsKICAgICAgaWYgKHRoaXMuY3VycmVudF9waG9uZS5wcmljZSA+IDMwMCkgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdGhpcy5jdXJyZW50X3Bob25lLmRpc3BsYXlzaXplID49IDYuNDsKICAgIH0sCiAgICAvL+WKoOWFpei0reeJqei9pgogICAgYWRkVG9DYXJ0OiBmdW5jdGlvbiBhZGRUb0NhcnQoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5zaG93X2Vycl9yZW1pbmRlciA9IGZhbHNlOwogICAgICB0aGlzLmxhc3RfYWN0aW9uID0gImFkZFRvQ2FydCI7CiAgICAgIHRoaXMuYm90KCJQbGVhc2UgcmF0ZSB5b3VyIGxpa2VkIHBob25lLiIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNS5zaG93X3JhdGUgPSB0cnVlOwogICAgICB9KTsKICAgICAgdGhpcy5sYXRlc3RfZGlhbG9nLnB1c2goewogICAgICAgICJhZ2VudCI6ICJ5b3UiLAogICAgICAgICJhY3Rpb24iOiAiQWNjZXB0X0l0ZW0iLAogICAgICAgICJ0aW1lc3RhbXAiOiBuZXcgRGF0ZSgpLmdldFRpbWUoKQogICAgICB9KTsKICAgICAgdGhpcy5hZGRMb2coJ2h1bWFuJywgdGhpcy5sYXN0X2FjdGlvbiwgdGhpcy5jdXJyZW50X3Bob25lLmlkICsgJ3wnICsgdGhpcy5jdXJyZW50X3Bob25lLm1vZGVsbmFtZSk7CiAgICB9LAogICAgLy/miYvmnLror4TliIYKICAgIHN1Ym1pdFBob25lUmF0ZTogZnVuY3Rpb24gc3VibWl0UGhvbmVSYXRlKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIC8vY29uc29sZS5sb2codGhpcy5jcml0X3Bob25lX3BvaW50KTsKICAgICAgdGhpcy5sYXN0X2FjdGlvbiA9ICdzdWJtaXRQaG9uZVJhdGUnOwoKICAgICAgaWYgKHRoaXMuY3VycmVudF9waG9uZS5yYXRlKSB7CiAgICAgICAgdGhpcy5waG9uZV9pbl9jYXJ0LnB1c2godGhpcy5jdXJyZW50X3Bob25lKTsKICAgICAgICB0aGlzLnNob3dfcmF0ZSA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5waG9uZV9pbl9jYXJ0Lmxlbmd0aCA9PT0gMykgewogICAgICAgICAgdGhpcy5zaG93X25leHRfcGFnZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGluc3RhbmNlLnBvc3QoIi9jaGF0L3VwZGF0ZW1vZGVsIiwgewogICAgICAgICAgICB1dWlkOiB0aGlzLnV1aWQsCiAgICAgICAgICAgIGxvZ2dlcjogdGhpcy5sYXRlc3RfZGlhbG9nLAogICAgICAgICAgICBleHBsYW5hdGlvbl9zdHlsZTogdGhpcy5leHBsYW5hdGlvbl9zdHlsZSwKICAgICAgICAgICAgbFRpbWU6IG5ldyBEYXRlKCkuZ2V0VGltZSgpCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgX3RoaXM2LmxhdGVzdF9kaWFsb2cgPSBbXTsKICAgICAgICAgICAgX3RoaXM2LmN1cnJlbnRfcGhvbmUgPSByZXMuZGF0YS5waG9uZTsKICAgICAgICAgICAgc3RvcmUuYWRkU2hvd2VkUGhvbmUocmVzLmRhdGEucGhvbmUpOwogICAgICAgICAgICB2YXIgc2VlZCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSk7CiAgICAgICAgICAgIHZhciB0ZW1wX21zZyA9IFsiSGVyZSBhcmUgc29tZSBvdGhlciBwaG9uZXMgeW91IG1heSB3YW50IHRvIGNoZWNrLiIsICJJIGZpbmQgdGhlc2UgcGhvbmVzIGFsc28gd29ydGggY2hlY2tpbmcuIl07CgogICAgICAgICAgICBfdGhpczYuYm90KHRlbXBfbXNnW3NlZWRdKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczYuYm90KHJlcy5kYXRhLm1zZywgX3RoaXM2LmV4cGxhbmF0aW9uX3N0eXBsZV9jb250cm9sKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzNi5leHBfY291bnQgKz0gMTsKCiAgICAgICAgICAgICAgICBfdGhpczYuYm90UGhvbmVDYXJkKF90aGlzNi5jdXJyZW50X3Bob25lKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kdG9hc3QoIlBsZWFzZSByYXRlIHRoaXMgcGhvbmUgZmlyc3QuIik7CiAgICAgIH0KICAgIH0sCiAgICAvL+WGjeadpeS4gOS4quaOqOiNkAogICAgdHJ5QW5vdGhlcjogZnVuY3Rpb24gdHJ5QW5vdGhlcigpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB0aGlzLnNob3dfZXJyX3JlbWluZGVyID0gZmFsc2U7CgogICAgICBpZiAodGhpcy5jYW5fc2hvd19lbnRlcl90aXBzICYmIHRoaXMubGFzdF9hY3Rpb24gPT09ICd0cnlBbm90aGVyJykgewogICAgICAgIHRoaXMuZW50ZXJfdGlwcygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubGFzdF9hY3Rpb24gPSAidHJ5QW5vdGhlciI7CiAgICAgICAgdGhpcy5odW1hbigiU2hvdyBhbm90aGVyIHBob25lIikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczcubGF0ZXN0X2RpYWxvZy5wdXNoKHsKICAgICAgICAgICAgImFnZW50IjogInlvdSIsCiAgICAgICAgICAgICJhY3Rpb24iOiAiTmV4dCIsCiAgICAgICAgICAgICJ0aW1lc3RhbXAiOiBuZXcgRGF0ZSgpLmdldFRpbWUoKQogICAgICAgICAgfSk7CgogICAgICAgICAgaW5zdGFuY2UucG9zdCgiL2NoYXQvdXBkYXRlbW9kZWwiLCB7CiAgICAgICAgICAgIHV1aWQ6IF90aGlzNy51dWlkLAogICAgICAgICAgICBsb2dnZXI6IF90aGlzNy5sYXRlc3RfZGlhbG9nLAogICAgICAgICAgICBleHBsYW5hdGlvbl9zdHlsZTogX3RoaXM3LmV4cGxhbmF0aW9uX3N0eWxlLAogICAgICAgICAgICBsVGltZTogbmV3IERhdGUoKS5nZXRUaW1lKCkKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBfdGhpczcubGF0ZXN0X2RpYWxvZyA9IFtdOwogICAgICAgICAgICBfdGhpczcuY3VycmVudF9waG9uZSA9IHJlcy5kYXRhLnBob25lOwogICAgICAgICAgICBzdG9yZS5hZGRTaG93ZWRQaG9uZShyZXMuZGF0YS5waG9uZSk7CiAgICAgICAgICAgIHZhciBzZWVkID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKTsKICAgICAgICAgICAgdmFyIHJlc190ZW1wID0gWyJPSyIsICdTdXJlJ107CgogICAgICAgICAgICBfdGhpczcuYm90KHJlc190ZW1wW3NlZWRdKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczcuYm90KHJlcy5kYXRhLm1zZywgX3RoaXM3LmV4cGxhbmF0aW9uX3N0eXBsZV9jb250cm9sKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzNy5leHBfY291bnQgKz0gMTsKCiAgICAgICAgICAgICAgICBfdGhpczcuYm90UGhvbmVDYXJkKF90aGlzNy5jdXJyZW50X3Bob25lKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8v5bem5LiK6KeSdGlwc+mDqOWIhgogICAgY2xpY2tIZWxwOiBmdW5jdGlvbiBjbGlja0hlbHAoKSB7CiAgICAgIHRoaXMuc2hvd19oZWxwID0gdHJ1ZTsKICAgICAgdGhpcy5oZWxwX3Nob3dlZF9jb3VudCArPSAxOwogICAgfSwKICAgIC8v5Yid5aeL5YyW5byV5a+86K+t55qE5YWl5Y+jCiAgICBncmVldGluZzogZnVuY3Rpb24gZ3JlZXRpbmcoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuaGVscF9zaG93ZWRfY291bnQgPT09IDEpIHsKICAgICAgICAvLyDliJ3lp4vnirbmgIEKICAgICAgICB2YXIgbXNnID0gIkhleSEgSeKAmW0gUmVjQm90LCBhbiA8Yj5hdXRvbWF0ZWQgY2hhdGJvdDwvYj4gYXQgUGhvbmVzaG9wLiI7CiAgICAgICAgaWYgKHRoaXMuaWRlbnRpdHlfY3VlID09PSAnMScpIG1zZyA9ICJIZWxsbyEgSeKAmW0gU3VzYW4sIDxiPiBhIHNhbGVzIGFzc2lzdGFudDwvYj4gd29ya2luZyBhdCBQaG9uZXNob3AuIjsKICAgICAgICB0aGlzLmJvdChtc2cpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM4LmFza19uYW1lKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBhc2tfcHJlZmVyOiBmdW5jdGlvbiBhc2tfcHJlZmVyKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHRoaXMubGFzdF9hY3Rpb24gPSAnYXNrX3ByZWZlcic7CiAgICAgIHRoaXMubXNnX2J0bl9jdHJsID0gdHJ1ZTsKICAgICAgdmFyIHVzZXJuYW1lID0gIlBhcnRpY2lwYW50LiI7CgogICAgICBpZiAodGhpcy5pZGVudGl0eV9jdWUgPT09ICcxJykgewogICAgICAgIHVzZXJuYW1lID0gdGhpcy51c2VybmFtZSArICcuJzsKICAgICAgfQoKICAgICAgdmFyIG1zZyA9IHVzZXJuYW1lICsgIiBJ4oCZbSBoYXBweSB0byBoZWxwIHlvdSB3aXRoIHlvdXIgcHVyY2hhc2UuIFdlIGhhdmUgYWxsIGRpZmZlcmVudCB0eXBlcyBvZiBtb2JpbGUgcGhvbmVzLiI7CiAgICAgIHRoaXMuYm90KG1zZykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzOS5ib3QoIlRvIGVuc3VyZSB0aGF0IEkgbWFrZSB0aGUgbW9zdCBzdWl0YWJsZSByZWNvbW1lbmRhdGlvbnMgZm9yIHlvdSwgSeKAmWQgbGlrZSB0byBhc2sgeW91IHNvbWUgcXVlc3Rpb25zLiIpOwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM5LmJvdCgiV2hhdCBpcyB5b3VyIG1heGltdW0gYnVkZ2V0IGZvciBidXlpbmcgYSBwaG9uZT8gIik7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGJvdHVpLmFjdGlvbi5idXR0b24oewogICAgICAgICAgYWRkTWVzc2FnZTogZmFsc2UsCiAgICAgICAgICBodW1hbjogZmFsc2UsCiAgICAgICAgICBhY3Rpb246IFt7CiAgICAgICAgICAgIHRleHQ6ICckMjAwJywKICAgICAgICAgICAgdmFsdWU6ICcyMDAnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIHRleHQ6ICckMzAwJywKICAgICAgICAgICAgdmFsdWU6ICczMDAnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIHRleHQ6ICckNDAwJywKICAgICAgICAgICAgdmFsdWU6ICc0MDAnCiAgICAgICAgICB9XQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgX3RoaXM5LnVzZXJfcHJlZmVyLmJ1ZGdldCA9IHJlcy52YWx1ZTsKICAgICAgICAgIHJldHVybiBfdGhpczkuaHVtYW4ocmVzLnRleHQpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIG1zZyA9ICJPa2F5LiI7CiAgICAgICAgICBpZiAoX3RoaXM5LmlkZW50aXR5X2N1ZSA9PT0gJzEnKSBtc2cgPSAiT2theS4gSSBrbm93IHlvdXIgYnVkZ2V0IGlzICQiICsgX3RoaXM5LnVzZXJfcHJlZmVyLmJ1ZGdldCArICcuJzsKICAgICAgICAgIHJldHVybiBfdGhpczkuYm90KG1zZyk7CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczkuYm90KCJCeSB0aGUgd2F5LCBkbyB5b3UgaGF2ZSBhbnkgc3BlY2lmaWMgcmVxdWlyZW1lbnRzIGluIHRoZSBmb2xsb3dpbmcgYXNwZWN0cz8iKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYm90dWkuYWN0aW9uLmJ1dHRvbih7CiAgICAgICAgICAgICAgYWRkTWVzc2FnZTogdHJ1ZSwKICAgICAgICAgICAgICBodW1hbjogdHJ1ZSwKICAgICAgICAgICAgICBhY3Rpb246IFt7CiAgICAgICAgICAgICAgICB0ZXh0OiAnRGlzcGxheSBzaXplJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnZGlzcGxheScKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0ZXh0OiAnQmF0dGVyeSBjYXBhY2l0eScsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2JhdHRlcnknCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdGV4dDogJ0JyYW5kJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnYnJhbmQnCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgdGV4dDogJ1dlaWdodCcsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ3dlaWdodCcKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICB0ZXh0OiAnTm8gUHJlZmVyZW5jZScsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ25vJwogICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIF90aGlzOS5hZGRMb2coJ2h1bWFuJywgX3RoaXM5Lmxhc3RfYWN0aW9uLCByZXMudGV4dCk7CgogICAgICAgICAgICAgIHN3aXRjaCAocmVzLnZhbHVlKSB7CiAgICAgICAgICAgICAgICBjYXNlICdkaXNwbGF5JzoKICAgICAgICAgICAgICAgICAgX3RoaXM5LmFza19zaXplKCk7CgogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlICdiYXR0ZXJ5JzoKICAgICAgICAgICAgICAgICAgX3RoaXM5LmFza19iYXR0ZXJ5KCk7CgogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlICdicmFuZCc6CiAgICAgICAgICAgICAgICAgIF90aGlzOS5hc2tfYnJhbmQoKTsKCiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgJ3dlaWdodCc6CiAgICAgICAgICAgICAgICAgIF90aGlzOS5hc2tfd2VpZ2h0KCk7CgogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlICdubyc6CiAgICAgICAgICAgICAgICAgIF90aGlzOS5zdWJtaXRQcmVmZXJlbmNlKCk7CgogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGFza19uYW1lOiBmdW5jdGlvbiBhc2tfbmFtZSgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMuYm90KCJ3aGF0IHNob3VsZCBJIGNhbGwgeW91PyIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMTAubXNnX2J0bl9jdHJsID0gZmFsc2U7CiAgICAgICAgX3RoaXMxMC5sYXN0X2FjdGlvbiA9ICdhc2tfdXNlcm5hbWUnOwogICAgICB9KTsKICAgIH0sCiAgICBhc2tfc2l6ZTogZnVuY3Rpb24gYXNrX3NpemUoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHZhciBtc2cgPSAiT2theS4iOwogICAgICB0aGlzLmxhc3RfYWN0aW9uID0gJ2Fza19zaXplJzsKICAgICAgaWYgKHRoaXMuaWRlbnRpdHlfY3VlID09PSAnMScpIG1zZyA9ICJPa2F5LiBJIHNlZSB0aGUgZGlzcGxheSBzaXplIG9mIHRoZSBtb2JpbGUgcGhvbmUgaXMgaW1wb3J0YW50IHRvIHlvdS4iOwogICAgICB0aGlzLmJvdChtc2cpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMTEuYm90KCIgV2hpY2ggZGlzcGxheSBzaXplIGFyZSB5b3UgbG9va2luZyBmb3I/IikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBib3R1aS5hY3Rpb24uYnV0dG9uKHsKICAgICAgICAgICAgYWRkTWVzc2FnZTogdHJ1ZSwKICAgICAgICAgICAgaHVtYW46IHRydWUsCiAgICAgICAgICAgIGFjdGlvbjogW3sKICAgICAgICAgICAgICB0ZXh0OiAnU21hbGwgKDIuNOKAsyAtIDYuMuKAsyknLAogICAgICAgICAgICAgIHZhbHVlOiAnU21hbGwnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICB0ZXh0OiAnTWVkaXVtICg2LjLigLMgLSA2LjXigLMpJywKICAgICAgICAgICAgICB2YWx1ZTogJ01lZGl1bScKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIHRleHQ6ICdMYXJnZSAoNi414oCzIC0gOC4w4oCzKScsCiAgICAgICAgICAgICAgdmFsdWU6ICdMYXJnZScKICAgICAgICAgICAgfV0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBfdGhpczExLmFkZExvZygnaHVtYW4nLCBfdGhpczExLmxhc3RfYWN0aW9uLCByZXMudGV4dCk7CgogICAgICAgICAgICBfdGhpczExLnVzZXJfcHJlZmVyLmRpc3BsYXlfc2l6ZSA9IHJlcy52YWx1ZTsKCiAgICAgICAgICAgIF90aGlzMTEuc3VibWl0UHJlZmVyZW5jZSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGFza19iYXR0ZXJ5OiBmdW5jdGlvbiBhc2tfYmF0dGVyeSgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdGhpcy5sYXN0X2FjdGlvbiA9ICdhc2tfYmF0dGVyeSc7CiAgICAgIHZhciBtc2cgPSAiT2theS4iOwogICAgICBpZiAodGhpcy5pZGVudGl0eV9jdWUgPT09ICcxJykgbXNnID0gIk9rYXkuIEkgc2VlIHRoZSBiYXR0ZXJ5IG9mIHRoZSBtb2JpbGUgcGhvbmUgaXMgaW1wb3J0YW50IHRvIHlvdS4iOwogICAgICB0aGlzLmJvdChtc2cpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMTIuYm90KCIgV2hpY2ggYmF0dGVyeSBjYXBhY2l0eSBhcmUgeW91IGxvb2tpbmcgZm9yPyIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgYm90dWkuYWN0aW9uLmJ1dHRvbih7CiAgICAgICAgICAgIGFkZE1lc3NhZ2U6IHRydWUsCiAgICAgICAgICAgIGh1bWFuOiB0cnVlLAogICAgICAgICAgICBhY3Rpb246IFt7CiAgICAgICAgICAgICAgdGV4dDogJ1NtYWxsICgxMzAwbUFoIC0gNDAwMG1BaCknLAogICAgICAgICAgICAgIHZhbHVlOiAnU21hbGwnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICB0ZXh0OiAnTWVkaXVtICg0MDAwbUFoIC0gNDUwMG1BaCknLAogICAgICAgICAgICAgIHZhbHVlOiAnTWVkaXVtJwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgdGV4dDogJ0xhcmdlKDQ1MDBtQWggLSAxMzAwMG1BaCknLAogICAgICAgICAgICAgIHZhbHVlOiAnTGFyZ2UnCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgX3RoaXMxMi5hZGRMb2coJ2h1bWFuJywgX3RoaXMxMi5sYXN0X2FjdGlvbiwgcmVzLnRleHQpOwoKICAgICAgICAgICAgX3RoaXMxMi51c2VyX3ByZWZlci5iYXR0ZXJ5ID0gcmVzLnZhbHVlOwoKICAgICAgICAgICAgX3RoaXMxMi5zdWJtaXRQcmVmZXJlbmNlKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgYXNrX2JyYW5kOiBmdW5jdGlvbiBhc2tfYnJhbmQoKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIHRoaXMubGFzdF9hY3Rpb24gPSAnYXNrX2JyYW5kJzsKICAgICAgdmFyIG1zZyA9ICJPa2F5LiI7CiAgICAgIGlmICh0aGlzLmlkZW50aXR5X2N1ZSA9PT0gJzEnKSBtc2cgPSAiT2theS4gSSBzZWUgdGhlIGJyYW5kIG9mIHRoZSBtb2JpbGUgcGhvbmUgaXMgaW1wb3J0YW50IHRvIHlvdS4iOwogICAgICB0aGlzLmJvdChtc2cpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMTMuYm90KCIgV2hpY2ggYnJhbmQgYXJlIHlvdSBsb29raW5nIGZvcj8iKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGJvdHVpLmFjdGlvbi5idXR0b24oewogICAgICAgICAgICBhZGRNZXNzYWdlOiB0cnVlLAogICAgICAgICAgICBodW1hbjogdHJ1ZSwKICAgICAgICAgICAgYWN0aW9uOiBbewogICAgICAgICAgICAgIHRleHQ6ICdBcHBsZScsCiAgICAgICAgICAgICAgdmFsdWU6ICdBcHBsZScKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIHRleHQ6ICdTYW1zdW5nJywKICAgICAgICAgICAgICB2YWx1ZTogJ1NhbXN1bmcnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICB0ZXh0OiAnSHVhd2VpJywKICAgICAgICAgICAgICB2YWx1ZTogJ0h1YXdlaScKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIHRleHQ6ICdPdGhlcicsCiAgICAgICAgICAgICAgdmFsdWU6ICdPdGhlcicKICAgICAgICAgICAgfV0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBfdGhpczEzLmFkZExvZygnaHVtYW4nLCBfdGhpczEzLmxhc3RfYWN0aW9uLCByZXMudGV4dCk7CgogICAgICAgICAgICBfdGhpczEzLnVzZXJfcHJlZmVyLmJyYW5kID0gcmVzLnZhbHVlOwoKICAgICAgICAgICAgX3RoaXMxMy5zdWJtaXRQcmVmZXJlbmNlKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgYXNrX3dlaWdodDogZnVuY3Rpb24gYXNrX3dlaWdodCgpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdGhpcy5sYXN0X2FjdGlvbiA9IHRoaXMuYXNrX3dlaWdodDsKICAgICAgdmFyIG1zZyA9ICJPa2F5LiI7CiAgICAgIGlmICh0aGlzLmlkZW50aXR5X2N1ZSA9PT0gJzEnKSBtc2cgPSAiT2theS4gSSBzZWUgdGhlIHdlaWdodCBvZiB0aGUgbW9iaWxlIHBob25lIGlzIGltcG9ydGFudCB0byB5b3UuIjsKICAgICAgdGhpcy5ib3QobXNnKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczE0LmJvdCgiIFdoaWNoIHdlaWdodCByYW5nZSBhcmUgeW91IGxvb2tpbmcgZm9yPyIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgYm90dWkuYWN0aW9uLmJ1dHRvbih7CiAgICAgICAgICAgIGFkZE1lc3NhZ2U6IHRydWUsCiAgICAgICAgICAgIGh1bWFuOiB0cnVlLAogICAgICAgICAgICBhY3Rpb246IFt7CiAgICAgICAgICAgICAgdGV4dDogJ0xpZ2h0ICgxMTdnLTE3M2cpJywKICAgICAgICAgICAgICB2YWx1ZTogJ0xpZ2h0JwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgdGV4dDogJ01lZGl1bSgxNzNnLTE4MWcpJywKICAgICAgICAgICAgICB2YWx1ZTogJ01lZGl1bScKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIHRleHQ6ICdIZWF2eSgxODFnLTIwM2cpJywKICAgICAgICAgICAgICB2YWx1ZTogJ0hlYXZ5JwogICAgICAgICAgICB9XQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgIF90aGlzMTQuYWRkTG9nKCdodW1hbicsIF90aGlzMTQubGFzdF9hY3Rpb24sIHJlcy50ZXh0KTsKCiAgICAgICAgICAgIF90aGlzMTQudXNlcl9wcmVmZXIud2VpZ2h0ID0gcmVzLnZhbHVlOwoKICAgICAgICAgICAgX3RoaXMxNC5zdWJtaXRQcmVmZXJlbmNlKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy/otK3nianovabpg6jliIYKICAgIGNsaWNrQ2FydDogZnVuY3Rpb24gY2xpY2tDYXJ0KCkgewogICAgICB0aGlzLnNob3dfY2FydCA9IHRydWU7CiAgICB9LAogICAgLy/ot7PliLDkuIvkuIDpobUKICAgIG5leHRQYWdlOiBmdW5jdGlvbiBuZXh0UGFnZSgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgaW5zdGFuY2UucG9zdCgnL2NoYXQvcGFnZTInLCB7CiAgICAgICAgJ3BhZ2UyVCc6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLAogICAgICAgICdjYXJ0JzogSlNPTi5zdHJpbmdpZnkodGhpcy5waG9uZV9pbl9jYXJ0KSwKICAgICAgICAnbG9nJzogSlNPTi5zdHJpbmdpZnkodGhpcy5sb2cpLAogICAgICAgICd1dWlkJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3V1aWQnKQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwoKICAgICAgICBfdGhpczE1LiRyb3V0ZXIucmVwbGFjZSgnL3F1ZTEnKS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGV4cF9jb3VudDogZnVuY3Rpb24gZXhwX2NvdW50KCkgewogICAgICBpZiAodGhpcy5leHBfY291bnQgPj0gMykgewogICAgICAgIHRoaXMuZXhwbGFuYXRpb25fc3R5bGUgPSAnMCc7CiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDorqHnrpflsZ7mgKfnmoQgZ2V0dGVyCiAgICBjYXJ0X2l0ZW1fY291bnQ6IGZ1bmN0aW9uIGNhcnRfaXRlbV9jb3VudCgpIHsKICAgICAgcmV0dXJuIHRoaXMucGhvbmVfaW5fY2FydC5sZW5ndGg7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwUA,wC,CACA;;AACA;AACA;AACA;AAEA;EACAA,iBADA;EAEAC;IACAC;EADA,CAFA;EAKAC;IACA;MACA;MACAC,gBAFA;MAGAC,qBAHA;MAIA;MACA;MACA;MACAC,YAPA;MAQAC,yCARA;MASAC,yBATA;MAUAC,wBAVA;MAWAC,cAXA;MAYAC,kBAZA;MAaAC,eAbA;MAcAC,gBAdA;MAeAC,sBAfA;MAgBAC,qBAhBA;MAiBAC,oBAjBA;MAkBAC,gBAlBA;MAmBAC,sBAnBA;MAoBAC,gBACA;QACAC,mBADA;QAEAC;MAFA,CADA,EAKA;QACAD,iBADA;QAEAC;MAFA,CALA,CApBA;MA+BA;MAEA;MACAC,kCAlCA;MAmCA;MACAC,qBApCA;MAqCAC,WArCA;MAsCAC;QACAC,SADA;QAEAC,WAFA;QAGAC,gBAHA;QAIAC,WAJA;QAKAC;MALA,CAtCA;MA6CAC,iBA7CA;MA8CAC,iBA9CA;MA+CAC,iBA/CA;MAgDA;MACAC,OAjDA;MAkDA;MACAC,eAnDA;MAoDA;MACAC,YArDA;MAsDAC;IAtDA;EAwDA,CA9DA;EA+DAC,OA/DA,qBA+DA;IACA;IACA;EACA,CAlEA;EAmEAC;IACA;IACAC;MACA;MACAC;MACA;IACA,CANA;IAOA;IACAC;MACA;MACA;QAAA;QAAA;QAAA;QAAA;MAAA;MACA;IACA,CAZA;IAcA;IACAC;MAAA;MACA;QACAC,YADA;QAEAC,eAFA;QAGAnC,aAHA;QAIAoC,SAJA;QAKAC,sFALA;QAMAC;MANA;;MAQA;QACAC;QACAA;MACA;;MACA;MACA;IACA,CA9BA;IA+BAC;MACA;MACA;QACAF;MADA;IAGA,CApCA;IAsCA;IACAG;MAAA;;MACA;QACAP,aADA;QAEAlC,aAFA;QAGAoC,UAHA;QAIAE;MAJA;;MAMA;QACAC;QACAA;MACA;;MACA;MACAG;QACAX;QACAW;UACAC,iBADA;UAEAH,YAFA;UAGAI;QAHA,GAIAC,IAJA,CAIA;UACA;UACA;YACA;cACA;YACA,CAFA,MAEA;cACA;cACAC;cACA;YACA;UACA;;UACA;YACA;UACA;;UACA;YACA;UACA;QACA,CArBA;MAsBA,CAxBA;IAyBA,CA5EA;IA8EA;IACAC;MAAA;;MACA;MACA;QACA;UACA;QACA,CAFA,EAEAF,IAFA,CAEA;UACA;QACA,CAJA,EAIAA,IAJA,CAIA;UACAH;YACAC,iBADA;YAEAH,WAFA;YAGAI,SACA;cACAlC,2BADA;cAEAC;YAFA,CADA,EAIA;cACAD,6BADA;cAEAC;YAFA,CAJA;UAHA,GAYAkC,IAZA,CAYA;YACA;YACA;;YACA;cACA;YACA,CAFA,MAEA;cACA;gBACA,8DACA,CADA;cAEA,CAHA;YAIA;UACA,CAvBA;QAwBA,CA7BA;MA8BA,CA/BA;IAgCA,CAjHA;IAkHA;IACAG,gBAnHA,8BAmHA;MAAA;;MACA;MACA;MACA;MACA;MACAC;QACA;QACA;UACA;UACA,+BAFA,CAGA;;UACAH,qCAJA,CAKA;;UACA;YACA,gBADA;YAEA,sBAFA;YAGA;UAHA;;UAKA;YACA;cACA;cACAf;;cACA;;cACA;YAEA,CANA;UAOA,CARA;QASA,CApBA,MAoBA;UACA;;UACA;QACA;MACA,CA1BA,EA0BAmB,KA1BA,CA0BA;QACAnB;QACA;;QACA;MACA,CA9BA;IA+BA,CAvJA;IA0JA;IACAoB;MAAA;;MACA;QACA;QACAT,oBAFA,CAGA;;QACA;QACA;UACA;UACA;YACA;YACA;YACA;;YACA;UACA,CALA,MAKA;YACA;;YACA;cACA,cADA;cAEA,sBAFA;cAGA,oBAHA;cAIA,yBAJA;cAKA,cALA;cAMA,yCANA;cAOA;YAPA;;YASAO;cACAG,0BADA;cAEAtC,uBAFA;cAGAnB,2CAHA;cAIA0D,4BAJA;cAKAzC;YALA,GAMAiC,IANA,CAMA;cACA;cACA;cACAC;cACA;cACA;;cACA;gBACA;kBACA;oBACA;kBACA,CAFA;gBAGA,CAJA;cAKA,CANA,MAMA;gBACA;kBACA;gBACA,CAFA;cAGA;;cACA;cACA;YACA,CAzBA,EAyBAI,KAzBA,CAyBA;cACA;;cACA;YACA,CA5BA;UA6BA;QACA,CAhDA;MAiDA,CAtDA,MAsDA;QACA;QACA;MACA;IAEA,CAvNA;IAyNA;IACAI;MACA;MACA;MACA;IACA,CA9NA;IA+NA;IACAC,SAhOA,uBAgOA;MAAA;;MACA;MACA;MACA;QACA;MACA,CAFA;MAGA;QACA,cADA;QAEA,uBAFA;QAGA;MAHA;MAKA;IACA,CA5OA;IA8OA;IACAC,eA/OA,6BA+OA;MAAA;;MACA;MACA;;MACA;QACA;QACA;;QACA;UACA;QACA,CAFA,MAEA;UACAP;YACArC,eADA;YAEAyC,0BAFA;YAGA1D,yCAHA;YAIA8D;UAJA,GAKAZ,IALA,CAKA;YACA;YACA;YACAC;YACA;YACA;;YACA;cACA;gBACA;;gBACA;cACA,CAHA;YAIA,CALA;UAMA,CAjBA;QAkBA;MACA,CAzBA,MAyBA;QACA;MACA;IACA,CA9QA;IAgRA;IACAY,UAjRA,wBAiRA;MAAA;;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;QACA,iCACAb,IADA,CACA;UACA;YACA,cADA;YAEA,gBAFA;YAGA;UAHA;;UAKAI;YACArC,iBADA;YAEAyC,4BAFA;YAGA1D,2CAHA;YAIA8D;UAJA,GAKAZ,IALA,CAKA;YACA;YACA;YACAC;YACA;YACA;;YACA;cACA;gBACA;;gBACA;cACA,CAHA;YAIA,CALA;UAMA,CAjBA;QAkBA,CAzBA;MA0BA;IACA,CAlTA;IAoTA;IACAa;MACA;MACA;IACA,CAxTA;IA0TA;IACAC;MAAA;;MACA;QACA;QACA;QACA;QACA;UACA;QACA,CAFA;MAGA;IACA,CApUA;IAqUAC;MAAA;;MACA;MACA;MACA;;MACA;QACAnC;MACA;;MACA;MACA;QACA;MACA,CAFA,EAEAmB,IAFA,CAEA;QACA;MACA,CAJA,EAIAA,IAJA,CAIA;QACAH;UACAC,iBADA;UAEAH,YAFA;UAGAI,SACA;YACAlC,YADA;YAEAC;UAFA,CADA,EAIA;YACAD,YADA;YAEAC;UAFA,CAJA,EAQA;YACAD,YADA;YAEAC;UAFA,CARA;QAHA,GAgBAkC,IAhBA,CAgBA;UACA;UACA;QACA,CAnBA,EAmBAA,IAnBA,CAmBA;UACA;UACA;UACA;QACA,CAvBA,EAuBAA,IAvBA,CAuBA;UACA;YACAH;cACAC,gBADA;cAEAH,WAFA;cAGAI,SACA;gBACAlC,oBADA;gBAEAC;cAFA,CADA,EAIA;gBACAD,wBADA;gBAEAC;cAFA,CAJA,EAQA;gBACAD,aADA;gBAEAC;cAFA,CARA,EAYA;gBACAD,cADA;gBAEAC;cAFA,CAZA,EAgBA;gBACAD,qBADA;gBAEAC;cAFA,CAhBA;YAHA,GAwBAkC,IAxBA,CAwBA;cACA;;cACA;gBACA;kBACA;;kBACA;;gBACA;kBACA;;kBACA;;gBACA;kBACA;;kBACA;;gBACA;kBACA;;kBACA;;gBACA;kBACA;;kBACA;cAfA;YAiBA,CA3CA;UA4CA,CA7CA;QA8CA,CAtEA;MAuEA,CA5EA;IA6EA,CA1ZA;IA2ZAiB;MAAA;;MACA;QACA;QACA;MACA,CAHA;IAIA,CAhaA;IAkaAC;MAAA;;MACA;MACA;MACA;MACA;QACA;UACArB;YACAC,gBADA;YAEAH,WAFA;YAGAI,SACA;cACAlC,2BADA;cAEAC;YAFA,CADA,EAIA;cACAD,4BADA;cAEAC;YAFA,CAJA,EAQA;cACAD,2BADA;cAEAC;YAFA,CARA;UAHA,GAgBAkC,IAhBA,CAgBA;YACA;;YACA;;YACA;UACA,CApBA;QAqBA,CAtBA;MAuBA,CAxBA;IAyBA,CA/bA;IAgcAmB;MAAA;;MACA;MACA;MACA;MACA;QACA;UACAtB;YACAC,gBADA;YAEAH,WAFA;YAGAI,SACA;cACAlC,iCADA;cAEAC;YAFA,CADA,EAIA;cACAD,kCADA;cAEAC;YAFA,CAJA,EAQA;cACAD,iCADA;cAEAC;YAFA,CARA;UAHA,GAgBAkC,IAhBA,CAgBA;YACA;;YACA;;YACA;UACA,CApBA;QAqBA,CAtBA;MAuBA,CAxBA;IAyBA,CA7dA;IA+dAoB;MAAA;;MACA;MACA;MACA;MACA;QACA;UACAvB;YACAC,gBADA;YAEAH,WAFA;YAGAI,SACA;cACAlC,aADA;cAEAC;YAFA,CADA,EAIA;cACAD,eADA;cAEAC;YAFA,CAJA,EAQA;cACAD,cADA;cAEAC;YAFA,CARA,EAYA;cACAD,aADA;cAEAC;YAFA,CAZA;UAHA,GAoBAkC,IApBA,CAoBA;YACA;;YACA;;YACA;UACA,CAxBA;QAyBA,CA1BA;MA2BA,CA5BA;IA6BA,CAhgBA;IAkgBAqB;MAAA;;MACA;MACA;MACA;MACA;QACA;UACAxB;YACAC,gBADA;YAEAH,WAFA;YAGAI,SACA;cACAlC,yBADA;cAEAC;YAFA,CADA,EAIA;cACAD,yBADA;cAEAC;YAFA,CAJA,EAQA;cACAD,wBADA;cAEAC;YAFA,CARA;UAHA,GAgBAkC,IAhBA,CAgBA;YACA;;YACA;;YACA;UACA,CApBA;QAqBA,CAtBA;MAuBA,CAxBA;IAyBA,CA/hBA;IAkiBA;IACAsB;MACA;IACA,CAriBA;IAuiBA;IACAC;MAAA;;MACAnB;QACA,8BADA;QAEA,0CAFA;QAGA,+BAHA;QAIA;MAJA,GAKAJ,IALA,CAKA;QACAd;;QACA;UACAA;QACA,CAFA;MAGA,CAVA;IAWA;EApjBA,CAnEA;EA0nBAsC;IACAzE;MACA;QACA;MACA;IACA;EALA,CA1nBA;EAioBA0E;IACA;IACAC;MACA;IACA;EAJA;AAjoBA","names":["name","components","BotUi","data","identity_cue","explanation_style","exp_count","explanation_styple_control","can_show_enter_tips","show_err_reminder","loading","msg_btn_ctrl","show_help","show_rate","show_preference","show_next_page","help_showed_count","show_cart","show_phone_page","phone_buttons","text","value","uuid","clicked_trans_url","message","user_prefer","brand","budget","display_size","battery","weight","phone_in_cart","current_phone","latest_dialog","log","last_action","username","bot_msg","mounted","methods","clicked_url","console","addLog","bot","type","cssClass","delay","photo","content","config","human","botPhoneCard","botui","addMessage","action","then","store","enter_tips","submitPreference","instance","catch","sendMessage","msgT","logger","checkBeforeToCart","addToCart","submitPhoneRate","lTime","tryAnother","clickHelp","greeting","ask_prefer","ask_name","ask_size","ask_battery","ask_brand","ask_weight","clickCart","nextPage","watch","computed","cart_item_count"],"sourceRoot":"src/views","sources":["Assistant.vue"],"sourcesContent":["<template>\n  <div class=\"chatbot\">\n    <van-nav-bar title='PhoneBot' @click-left=\"clickHelp\" @click-right=\"clickCart\" left-text=\"\"\n                 right-text=\"Cart\" class=\"chatbot-header\">\n      <template #left>\n        <van-icon name=\"info-o\" size=\"16\"><span\n            style=\"color: #1989fa;font-size: 16px;font-family:-apple-system,BlinkMacSystemFont,'Helvetica Neue',Helvetica,Segoe UI,Arial,Roboto,'PingFang SC',miui,'Hiragino Sans GB','Microsoft Yahei',sans-serif \">Tips</span>\n        </van-icon>\n\n      </template>\n      <template #right>\n        <van-icon name=\"cart-o\" size=\"16\" :badge=\"cart_item_count\"><span\n            style=\"color: #1989fa;font-size: 16px;font-family:-apple-system,BlinkMacSystemFont,'Helvetica Neue',Helvetica,Segoe UI,Arial,Roboto,'PingFang SC',miui,'Hiragino Sans GB','Microsoft Yahei',sans-serif \">Cart</span>\n        </van-icon>\n      </template>\n    </van-nav-bar>\n    <div class=\"chatbot-send\">\n      <van-field\n          v-model=\"message\"\n          rows=\"1\"\n          autosize\n      >\n        <template #button>\n          <van-button size=\"small\" :disabled=\"msg_btn_ctrl\" type=\"info\" @click=\"sendMessage\"> Send</van-button>\n        </template>\n      </van-field>\n    </div>\n    <div class=\"chatbot-content\">\n      <BotUi v-on:clicked_url=\"clicked_url\"></BotUi>\n    </div>\n\n    <!-- 初始化的偏好-->\n    <van-popup\n        v-model=\"show_preference\"\n        :style=\"{width:'90%'}\"\n        :close-on-click-overlay=\"false\"\n        round\n    >\n      <van-nav-bar title='My Preference'/>\n      <div class=\"phone_preference\">\n        <van-form @submit=\"submitPreference\">\n          <p style=\"padding:0 10px 0 16px; margin-bottom: 5px;\">Please select no more than three brands you like.</p>\n          <van-field name=\"brands\" :rules=\"[{ required: true, message: 'Please select' }]\">\n            <template #input>\n              <van-checkbox-group v-model=\"user_prefer.brands\" :max=\"3\" direction=\"horizontal\">\n                <van-checkbox name=\"Xiaomi\" shape=\"square\">Xiaomi</van-checkbox>\n                <van-checkbox name=\"vivo\" shape=\"square\">vivo</van-checkbox>\n                <van-checkbox name=\"Oppo\" shape=\"square\">Oppo</van-checkbox>\n                <van-checkbox name=\"Samsung\" shape=\"square\">Samsung</van-checkbox>\n                <van-checkbox name=\"Realme\" shape=\"square\">Realme</van-checkbox>\n                <van-checkbox name=\"Motorola\" shape=\"square\">Motorola</van-checkbox>\n                <van-checkbox name=\"Honor\" shape=\"square\">Honor</van-checkbox>\n                <van-checkbox name=\"Huawei\" shape=\"square\">Huawei</van-checkbox>\n                <van-checkbox name=\"ZTE\" shape=\"square\">ZTE</van-checkbox>\n                <van-checkbox name=\"BLU\" shape=\"square\">BLU</van-checkbox>\n                <van-checkbox name=\"Nokia\" shape=\"square\">Nokia</van-checkbox>\n                <van-checkbox name=\"LG\" shape=\"square\">LG</van-checkbox>\n                <van-checkbox name=\"Ulefone\" shape=\"square\">Ulefone</van-checkbox>\n                <van-checkbox name=\"TCL\" shape=\"square\">TCL</van-checkbox>\n                <van-checkbox name=\"OnePlus\" shape=\"square\">OnePlus</van-checkbox>\n                <van-checkbox name=\"alcatel\" shape=\"square\">alcatel</van-checkbox>\n                <van-checkbox name=\"Asus\" shape=\"square\">Asus</van-checkbox>\n                <van-checkbox name=\"Lenovo\" shape=\"square\">Lenovo</van-checkbox>\n                <van-checkbox name=\"Sony\" shape=\"square\">Sony</van-checkbox>\n                <van-checkbox name=\"HTC\" shape=\"square\">HTC</van-checkbox>\n                <van-checkbox name=\"Meizu\" shape=\"square\">Meizu</van-checkbox>\n                <van-checkbox name=\"Wiko\" shape=\"square\">Wiko</van-checkbox>\n                <van-checkbox name=\"Tecno\" shape=\"square\">Tecno</van-checkbox>\n                <van-checkbox name=\"Lava\" shape=\"square\">Lava</van-checkbox>\n                <van-checkbox name=\"Infinix\" shape=\"square\">Infinix</van-checkbox>\n                <van-checkbox name=\"Google\" shape=\"square\">Google</van-checkbox>\n                <van-checkbox name=\"Apple\" shape=\"square\">Apple</van-checkbox>\n              </van-checkbox-group>\n            </template>\n          </van-field>\n\n          <p style=\"padding:0 10px 0 16px; margin-bottom: 5px;\">Your Maximum Budget: <span\n              style=\"color: #B24040\">${{ user_prefer.budget }}</span></p>\n          <van-field name=\"budget\" :rules=\"[{ required: true, message: 'please select' }]\">\n            <template #input>\n              <van-slider :min=\"100\" :max=\"1400\" :step=\"100\" v-model=\"user_prefer.budget\"/>\n            </template>\n          </van-field>\n          <p style=\"padding:0 10px 0 16px; margin-bottom: 5px;\">Main Camera Minimum Resolution: <span\n              style=\"color: #B24040\">{{ user_prefer.cameras }}MP</span></p>\n          <van-field name=\"cameras\" :rules=\"[{ required: true, message: 'please select' }]\">\n            <template #input>\n              <van-slider :min=\"0\" :max=\"108\" :step=\"6\" v-model=\"user_prefer.cameras\"/>\n            </template>\n          </van-field>\n          <div style=\"margin: 16px;\">\n            <van-button round block type=\"info\" native-type=\"submit\">Continue</van-button>\n          </div>\n        </van-form>\n      </div>\n    </van-popup>\n    <!--  左侧 help-->\n    <van-popup\n        v-model=\"show_help\"\n        :style=\"{ height: '520px',width:'90%',overflow:'hidden'}\"\n        @close=\"greeting\"\n        :close-on-click-overlay=\"true\"\n        round\n    >\n      <div class=\"help\">\n        <van-nav-bar\n            right-text=\"Close\"\n            :fixed=\"true\"\n            @click-right=\"show_help=!show_help\"\n        />\n        <!--        <div style=\"position: fixed;top: 0\">-->\n        <!--          <van-button type=\"info\" block @click=\"show_help=!show_help\" round > Close</van-button>-->\n        <!--        </div>-->\n        <div\n            style=\"width:100%; box-sizing: border-box; margin-top: 36px; position: absolute; top:0; left: 0;padding: 0 10px 10px 10px; overflow-y: scroll;-webkit-overflow-scrolling: touch;height: 480px\">\n          <h3>Tips for chatting for phone searching</h3>\n\n          <h4>By price:</h4>\n          <ul>\n            <li>\"I want to buy a cheaper price phone.\"</li>\n            <li>\"The price can be higher.\"</li>\n          </ul>\n\n          <h4>By brand:</h4>\n          <ul>\n            <li>\"I like the iPhone.\"</li>\n            <li>\"I want to buy a Huawei mobile phone.\"</li>\n          </ul>\n\n          <h4>By size:</h4>\n          <ul>\n            <li>\"I like a light weight phone.\"</li>\n            <li>\"I want to buy a phone with a slim body.\"</li>\n          </ul>\n\n          <h4>By display:</h4>\n          <ul>\n            <li>\"I need a phone having better display.\"</li>\n            <li>\"I want a phone having higher resolution.\"</li>\n          </ul>\n\n          <h4> By storage:</h4>\n          <ul>\n            <li>\"I need a phone with a large storage.\"</li>\n            <li>\"I need a phone having more space for saving my photos.\"</li>\n          </ul>\n          <h4>By computing performance:</h4>\n          <ul>\n            <li>\"I want to buy a phone having larger RAM.\"</li>\n            <li>\"I want to buy a phone having better CPU.\"</li>\n            <li>\"I want to buy a phone running applications faster.\"</li>\n          </ul>\n\n          <h4>By operating system:</h4>\n          <ul>\n            <li>\"I want to buy an Android phone.\"</li>\n            <li>\"I like the ios system.\"</li>\n          </ul>\n          <br>\n        </div>\n      </div>\n    </van-popup>\n\n    <!--右侧购物车-->\n    <van-popup\n        v-model=\"show_cart\"\n        closeable\n        close-icon=\"close\"\n        position=\"right\"\n        round\n        :style=\"{ height: '100%',width:'80%' }\"\n    >\n      <div class=\"cart\" style=\"margin-top:3em\">\n        <van-card v-for=\"item in phone_in_cart\" :key=\"item.id\"\n                  :thumb=\"item.img\">\n          <template #title>\n            <div style=\"font-size: 16px;font-weight: bolder;\">{{ item.modelname }}</div>\n          </template>\n          <template #price>\n            <div style=\"font-weight:bold;font-size:16px;color: #B24040\">${{ item.price }}</div>\n          </template>\n          <template #num>\n            <div>Rating:{{ item.rate }}</div>\n          </template>\n          <template #tags>\n            <div>\n              <van-tag plain type=\"primary\" style=\"margin:2px\">Storage:{{ item.storage }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin:2px\">RAM:{{ item.ram }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin:2px\">{{ item.os1 }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.cam1 }}MP</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.displaysize }}inches</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.resolution1 }}*{{ item.resolution2 }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.battery }}mAh</van-tag>\n            </div>\n          </template>\n        </van-card>\n      </div>\n    </van-popup>\n\n    <van-popup\n        v-model=\"show_phone_page\"\n        closeable\n        close-icon=\"close\"\n        position=\"left\"\n        round\n        :style=\"{ height: '100%',width:'100%' }\"\n    >\n      <div class=\"cart\" style=\"margin-top:3em;height: 100%\">\n        <iframe style=\"width: 100%;height: 100%\" :src=\"clicked_trans_url\"/>\n      </div>\n    </van-popup>\n\n    <!--    评分框-->\n    <van-popup\n        v-model=\"show_rate\"\n        :style=\"{width:'300px' }\"\n        :close-on-click-overlay=\"false\"\n        round\n    >\n      <div class=\"rate\">\n        <van-nav-bar title='Please rate this phone'/>\n        <van-card\n            :thumb=\"current_phone.img\">\n          <template #title>\n            <div style=\"font-size: 16px;font-weight: bolder;\">{{ current_phone.modelname }}</div>\n          </template>\n          <template #price>\n            <div style=\"font-weight:bold;font-size:16px;color: #B24040\">${{ current_phone.price }}</div>\n          </template>\n          <template #tags>\n            <div>\n              <van-tag plain type=\"primary\" style=\"margin:2px\">Storage:{{ current_phone.storage }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin:2px\">RAM:{{ current_phone.ram }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin:2px\">{{ current_phone.os1 }}</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ current_phone.cam1 }}MP</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ current_phone.displaysize }}inches</van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">\n                {{ current_phone.resolution1 }}*{{ current_phone.resolution2 }}\n              </van-tag>\n              <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ current_phone.battery }}mAh</van-tag>\n            </div>\n          </template>\n        </van-card>\n        <div style=\"display: flex;justify-content: center;margin: 24px 0;\">\n          <van-rate v-model=\"current_phone.rate\"/>\n        </div>\n        <van-button type=\"info\" block @click=\"submitPhoneRate\">Submit</van-button>\n      </div>\n    </van-popup>\n\n    <!-- 提醒 -->\n    <van-popup\n        v-model=\"show_err_reminder\"\n        :style=\"{width:'80%'}\"\n        :close-on-click-overlay=\"false\"\n        round\n    >\n      <van-nav-bar title='A kind reminder'/>\n      <div style=\"padding: 12px\">\n        <h4 style=\"color: #B24040\">It seems this phone cannot meet Lily’s requirements.</h4>\n\n        <p>Please keep Lily’s preferences in mind when you pick mobile phones for her.</p>\n        <ul>\n          <li>1. She often uses her mobile phone to watch videos.</li>\n          <li>2. She hates frequently charging her mobile phone.</li>\n          <li>3. Her budget for purchasing a new mobile phone is 300 US dollars.</li>\n        </ul>\n        <p style=\"text-align: center\">\n          <van-button type=\"info\" @click=\"tryAnother\"> Check other phones</van-button>\n          <br>\n          <br>\n          <a style=\"color: #1989fa\" @click=\"addToCart\"> Still add to cart</a>\n        </p>\n      </div>\n\n    </van-popup>\n    <!-- 去下一页   -->\n    <van-popup\n        v-model=\"show_next_page\"\n        :style=\"{width:'300px' }\"\n        :close-on-click-overlay=\"false\"\n        round\n    >\n      <div class=\"rate\">\n        <van-nav-bar title='Next Step'/>\n        <div class=\"cart\">\n          <van-card v-for=\"item in phone_in_cart\" :key=\"item.id\"\n                    :thumb=\"item.img\">\n            <template #title>\n              <div style=\"font-size: 16px;font-weight: bolder;\">{{ item.modelname }}</div>\n            </template>\n            <template #price>\n              <div style=\"font-weight:bold;font-size:16px;color: #B24040\">${{ item.price }}</div>\n            </template>\n            <template #num>\n              <div>Rating:{{ item.rate }}</div>\n            </template>\n            <template #tags>\n              <div>\n                <van-tag plain type=\"primary\" style=\"margin:2px\">Storage:{{ item.storage }}</van-tag>\n                <van-tag plain type=\"primary\" style=\"margin:2px\">RAM:{{ item.ram }}</van-tag>\n                <van-tag plain type=\"primary\" style=\"margin:2px\">{{ item.os1 }}</van-tag>\n                <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.cam1 }}MP</van-tag>\n                <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.displaysize }}inches</van-tag>\n                <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.resolution1 }}*{{\n                    item.resolution2\n                  }}\n                </van-tag>\n                <van-tag plain type=\"primary\" style=\"margin: 2px\">{{ item.battery }}mAh</van-tag>\n              </div>\n            </template>\n          </van-card>\n        </div>\n        <p v-if=\"identity_cue==='0'\" style=\"padding:0 16px;color: black\">I am glad you found these good phones for\n          Lily. Now, you\n          will be asked to complete a questionnaire regarding your experience of chatting with <b> RecBot (an automated\n            sales chatbot)</b></p>\n        <p v-if=\"identity_cue==='1'\" style=\"padding:0 16px;color: black;\">I am glad you found these good phones for\n          Lily. Now, you\n          will be asked to complete a questionnaire regarding your experience of chatting with <b>Susan (a sales\n            assistant).</b></p>\n        <van-button type=\"primary\" block @click=\"nextPage\">Next</van-button>\n      </div>\n    </van-popup>\n  </div>\n</template>\n\n<script>\nimport BotUi from \"../components/BotUi\";\n// 对象引入\nimport {botui} from '@/components/BotUi';\nimport {instance} from \"@/request\";\nimport {store} from \"@/store\";\n\nexport default {\n  name: \"Assistant\",\n  components: {\n    BotUi,\n  },\n  data: function () {\n    return {\n      //实验条件\n      identity_cue: \"\",\n      explanation_style: \"\",\n      //控制功能\n      //是否展示过输入提示。\n      // 解释展示的数量\n      exp_count: 0,\n      explanation_styple_control: 'explanation',\n      can_show_enter_tips: true,\n      show_err_reminder: false,\n      loading: false,\n      msg_btn_ctrl: true,\n      show_help: true,\n      show_rate: false,\n      show_preference: false,\n      show_next_page: false,\n      help_showed_count: 1,\n      show_cart: false,\n      show_phone_page: false,\n      phone_buttons: [\n        {\n          text: 'Add to cart',\n          value: 'Add to cart'\n        },\n        {\n          text: 'Next item',\n          value: 'Next item'\n        },\n      ],\n\n      //current action\n\n      //数据部分\n      uuid: localStorage.getItem(\"uuid\"),\n      //uuid: 'e34cddc4a7ae47bb9f7badf9e44cf41e',\n      clicked_trans_url: \"\",\n      message: \"\",\n      user_prefer: {\n        brand: '',\n        budget: 700,\n        display_size: '',\n        battery: '',\n        weight: ''\n      },\n      phone_in_cart: [],\n      current_phone: {},\n      latest_dialog: [],\n      //log\n      log: [],\n      //最后一次的动作\n      last_action: \"\",\n      //用户的名字\n      username: \"\",\n      bot_msg: ['I find this phone for you.', 'You may like this phone.', 'Please check this phone.']\n    }\n  },\n  mounted() {\n    this.explanation_style = localStorage.getItem(\"explanation_style\")\n    this.identity_cue = localStorage.getItem(\"identity_cue\")\n  },\n  methods: {\n    //从卡片组件里面获得点击事件的url\n    clicked_url: function (childValue) {\n      this.clicked_trans_url = \"https://www.chatbot.fans:3000/?url=\" + childValue\n      console.log(this.clicked_trans_url)\n      this.show_phone_page = true;\n    },\n    //添加日志打点\n    addLog: function (type, actionName, content) {\n      let logtime = new Date().getTime();\n      let log = {'type': type, 'action': actionName, 'content': content, 'logtime': logtime}\n      this.log.push(log)\n    },\n\n    //默认对话\n    bot: function (msg, style = \"\") {\n      let config = {\n        type: 'html',\n        cssClass: style,\n        loading: true,\n        delay: 10,\n        photo: \"https://musicbot-1251052535.cos.ap-shanghai.myqcloud.com/phonebot/avatar1.png\",\n        content: msg\n      };\n      if (this.identity_cue === '1') {\n        config.photo = \"https://musicbot-1251052535.cos.ap-shanghai.myqcloud.com/phonebot/avatar2.png\";\n        config.delay = msg.length * 40\n      }\n      this.addLog('bot', this.last_action, msg)\n      return botui.message.bot(config)\n    },\n    human: function (msg) {\n      this.addLog('human', this.last_action, msg)\n      return botui.message.human({\n        content: msg\n      })\n    },\n\n    //商品卡片\n    botPhoneCard: function (phone) {\n      let config = {\n        type: 'phone',\n        loading: true,\n        delay: 100,\n        content: phone,\n      }\n      if (this.identity_cue === '1') {\n        config.photo = \"https://musicbot-1251052535.cos.ap-shanghai.myqcloud.com/phonebot/avatar2.png\";\n        config.delay = 1600\n      }\n      this.addLog('bot', 'phonecard', phone.id + '|' + phone.modelname)\n      botui.message.bot(config).then(() => {\n        console.log(botui)\n        botui.action.button({\n          addMessage: false,\n          human: false,\n          action: this.phone_buttons\n        }).then((res) => {\n          //判断点了什么按钮\n          if (res.text === 'Add to cart') {\n            if (this.checkBeforeToCart()) {\n              this.addToCart();\n            } else {\n              //提示当前的手机是有过提醒的\n              store.setWarning();\n              this.show_err_reminder = true;\n            }\n          }\n          if (res.text === 'Next item') {\n            this.tryAnother();\n          }\n          if (res.text === 'Let bot suggest') {\n            this.letBotSuggest()\n          }\n        })\n      })\n    },\n\n    // 提示可以输入\n    enter_tips: function () {\n      this.last_action = 'enter_tips'\n      this.bot(\"If you are not satisfied with current recommendations, you can modify your requirement by typing in the input field.\").then(() => {\n        this.bot(\"For example, you could say:\").then(() => {\n          return this.bot(\"\\\"I need a (small / medium / large) display\\\"\")\n        }).then(() => {\n          return this.bot(\"\\\"I need a phone with (low / medium / high) battery capacity\\\"\")\n        }).then(() => {\n          botui.action.button({\n            addMessage: false,\n            human: true,\n            action: [\n              {\n                text: 'Next recommendation',\n                value: 'next'\n              }, {\n                text: 'Modify my requirement',\n                value: 'modify'\n              }\n            ]\n          }).then((res) => {\n            //再也不显示这个提示了\n            this.can_show_enter_tips = false;\n            if (res.value === 'next') {\n              this.tryAnother()\n            } else {\n              this.human(\"Modify my requirement\").then(() => {\n                this.bot(\"OK, tell me your requirement.\").then(() => {\n                })\n              })\n            }\n          })\n        })\n      })\n    },\n//初始化用户偏好\n    submitPreference() {\n      this.user_prefer.username = this.username;\n      this.user_prefer.uuid = localStorage.getItem('uuid');\n      this.user_prefer.preferT = new Date().getTime();\n      this.user_prefer.explanation_style = this.explanation_style\n      instance.post('/chat/prefer', this.user_prefer).then((res) => {\n        //console.log(res)\n        if (res.data.status === 1) {\n          this.loading = false;\n          this.show_preference = false;\n          //this.current_phone = res.data.phone;\n          store.addShowedPhone(res.data.phone)\n          //添加操作记录\n          this.latest_dialog.push({\n            \"agent\": \"robot\",\n            \"action\": \"Initialize\",\n            \"timestamp\": new Date().getTime()\n          })\n          this.bot(\"Ok, I see it!\").then(() => {\n            this.bot(res.data.msg, this.explanation_styple_control).then(() => {\n              this.exp_count += 1;\n              console.log(store)\n              this.botPhoneCard(res.data.phone.id);\n              this.msg_btn_ctrl = false;\n\n            })\n          });\n        } else {\n          this.loading = false;\n          this.$toast(\"Please read and accept the informed consent first.\")\n        }\n      }).catch((err) => {\n        console.log(err.message);\n        this.loading = false;\n        this.$toast(\"Network error, please try again.\");\n      })\n    }\n    ,\n\n//发送用户消息\n    sendMessage: function () {\n      if (this.message.length >= 2) {\n        //先移除按钮\n        botui.action.hide();\n        //可以发送\n        this.msg_btn_ctrl = true;\n        this.human(this.message).then(() => {\n          //这里是问名字\n          if (this.last_action === 'ask_username') {\n            this.username = this.message;\n            this.msg_btn_ctrl = false;\n            this.message = null;\n            this.ask_prefer()\n          } else {\n            this.last_action = 'sendMessage';\n            this.latest_dialog.push({\n              \"agent\": \"you\",\n              \"text\": this.message,\n              \"modality\": \"typing\",\n              \"action\": \"User_Critique\",\n              \"critique\": [],\n              \"critiqued_item\": this.current_phone.id,\n              \"timestamp\": new Date().getTime()\n            })\n            instance.post('/chat/userMessage', {\n              msgT: new Date().getTime(),\n              message: this.message,\n              explanation_style: this.explanation_style,\n              logger: this.latest_dialog,\n              uuid: localStorage.getItem('uuid'),\n            }).then((res) => {\n              //console.log(res);\n              this.current_phone = res.data.phone;\n              store.addShowedPhone(res.data.phone)\n              this.latest_dialog = [];\n              this.exp_count += 1;\n              if (this.identity_cue === '1') {\n                this.bot(\"Ok, I see it!\").then(() => {\n                  this.bot(res.data.msg, this.explanation_styple_control).then(() => {\n                    this.botPhoneCard(this.current_phone);\n                  })\n                });\n              } else {\n                this.bot(res.data.msg, this.explanation_styple_control).then(() => {\n                  this.botPhoneCard(this.current_phone);\n                })\n              }\n              this.msg_btn_ctrl = false;\n              this.message = null;\n            }).catch(() => {\n              this.msg_btn_ctrl = false;\n              this.$toast('Please try again.');\n            })\n          }\n        })\n      } else {\n        this.msg_btn_ctrl = false;\n        this.$toast('Please enter more information.');\n      }\n\n    },\n\n//加入购物车前的检查\n    checkBeforeToCart: function () {\n      if (this.current_phone.battery <= 4050) return false\n      if (this.current_phone.price > 300) return false\n      return this.current_phone.displaysize >= 6.4;\n    },\n//加入购物车\n    addToCart() {\n      this.show_err_reminder = false;\n      this.last_action = \"addToCart\";\n      this.bot(\"Please rate your liked phone.\").then(() => {\n        this.show_rate = true\n      })\n      this.latest_dialog.push({\n        \"agent\": \"you\",\n        \"action\": \"Accept_Item\",\n        \"timestamp\": new Date().getTime()\n      })\n      this.addLog('human', this.last_action, this.current_phone.id + '|' + this.current_phone.modelname)\n    },\n\n//手机评分\n    submitPhoneRate() {\n      //console.log(this.crit_phone_point);\n      this.last_action = 'submitPhoneRate';\n      if (this.current_phone.rate) {\n        this.phone_in_cart.push(this.current_phone);\n        this.show_rate = false;\n        if (this.phone_in_cart.length === 3) {\n          this.show_next_page = true;\n        } else {\n          instance.post(\"/chat/updatemodel\", {\n            uuid: this.uuid,\n            logger: this.latest_dialog,\n            explanation_style: this.explanation_style,\n            lTime: new Date().getTime(),\n          }).then((res) => {\n            this.latest_dialog = [];\n            this.current_phone = res.data.phone;\n            store.addShowedPhone(res.data.phone)\n            let seed = Math.round(Math.random());\n            let temp_msg = [\"Here are some other phones you may want to check.\", \"I find these phones also worth checking.\"]\n            this.bot(temp_msg[seed]).then(() => {\n              this.bot(res.data.msg, this.explanation_styple_control).then(() => {\n                this.exp_count += 1;\n                this.botPhoneCard(this.current_phone);\n              });\n            })\n          })\n        }\n      } else {\n        this.$toast(\"Please rate this phone first.\")\n      }\n    },\n\n//再来一个推荐\n    tryAnother() {\n      this.show_err_reminder = false;\n      if (this.can_show_enter_tips && this.last_action === 'tryAnother') {\n        this.enter_tips()\n      } else {\n        this.last_action = \"tryAnother\";\n        this.human(\"Show another phone\",\n        ).then(() => {\n          this.latest_dialog.push({\n            \"agent\": \"you\",\n            \"action\": \"Next\",\n            \"timestamp\": new Date().getTime()\n          })\n          instance.post(\"/chat/updatemodel\", {\n            uuid: this.uuid,\n            logger: this.latest_dialog,\n            explanation_style: this.explanation_style,\n            lTime: new Date().getTime(),\n          }).then((res) => {\n            this.latest_dialog = [];\n            this.current_phone = res.data.phone;\n            store.addShowedPhone(res.data.phone)\n            let seed = Math.round(Math.random());\n            let res_temp = [\"OK\", 'Sure']\n            this.bot(res_temp[seed]).then(() => {\n              this.bot(res.data.msg, this.explanation_styple_control).then(() => {\n                this.exp_count += 1;\n                this.botPhoneCard(this.current_phone);\n              });\n            })\n          })\n        })\n      }\n    },\n\n//左上角tips部分\n    clickHelp: function () {\n      this.show_help = true;\n      this.help_showed_count += 1;\n    },\n\n//初始化引导语的入口\n    greeting: function () {\n      if (this.help_showed_count === 1) {\n        // 初始状态\n        let msg = \"Hey! I’m RecBot, an <b>automated chatbot</b> at Phoneshop.\"\n        if (this.identity_cue === '1') msg = \"Hello! I’m Susan, <b> a sales assistant</b> working at Phoneshop.\"\n        this.bot(msg).then(() => {\n          this.ask_name()\n        })\n      }\n    },\n    ask_prefer: function () {\n      this.last_action = 'ask_prefer'\n      this.msg_btn_ctrl = true;\n      let username = \"Participant.\";\n      if (this.identity_cue === '1') {\n        username = this.username + '.';\n      }\n      let msg = username + \" I’m happy to help you with your purchase. We have all different types of mobile phones.\"\n      this.bot(msg).then(() => {\n        return this.bot(\"To ensure that I make the most suitable recommendations for you, I’d like to ask you some questions.\")\n      }).then(() => {\n        return this.bot(\"What is your maximum budget for buying a phone? \")\n      }).then(() => {\n        botui.action.button({\n          addMessage: false,\n          human: false,\n          action: [\n            {\n              text: '$200',\n              value: '200'\n            }, {\n              text: '$300',\n              value: '300'\n            },\n            {\n              text: '$400',\n              value: '400'\n            },\n          ]\n        }).then(res => {\n          this.user_prefer.budget = res.value;\n          return this.human(res.text)\n        }).then(() => {\n          let msg = \"Okay.\"\n          if (this.identity_cue === '1') msg = \"Okay. I know your budget is $\" + this.user_prefer.budget + '.'\n          return this.bot(msg)\n        }).then(() => {\n          this.bot(\"By the way, do you have any specific requirements in the following aspects?\").then(() => {\n            botui.action.button({\n              addMessage: true,\n              human: true,\n              action: [\n                {\n                  text: 'Display size',\n                  value: 'display'\n                }, {\n                  text: 'Battery capacity',\n                  value: 'battery'\n                },\n                {\n                  text: 'Brand',\n                  value: 'brand'\n                },\n                {\n                  text: 'Weight',\n                  value: 'weight'\n                },\n                {\n                  text: 'No Preference',\n                  value: 'no'\n                },\n              ]\n            }).then(res => {\n              this.addLog('human', this.last_action, res.text)\n              switch (res.value) {\n                case 'display':\n                  this.ask_size()\n                  break\n                case 'battery':\n                  this.ask_battery();\n                  break;\n                case 'brand':\n                  this.ask_brand();\n                  break;\n                case 'weight':\n                  this.ask_weight();\n                  break\n                case 'no':\n                  this.submitPreference()\n                  break;\n              }\n            })\n          })\n        })\n      })\n    },\n    ask_name: function () {\n      return this.bot(\"what should I call you?\").then(() => {\n        this.msg_btn_ctrl = false\n        this.last_action = 'ask_username'\n      })\n    },\n\n    ask_size: function () {\n      let msg = \"Okay.\"\n      this.last_action = 'ask_size'\n      if (this.identity_cue === '1') msg = \"Okay. I see the display size of the mobile phone is important to you.\"\n      this.bot(msg).then(() => {\n        this.bot(\" Which display size are you looking for?\").then(() => {\n          botui.action.button({\n            addMessage: true,\n            human: true,\n            action: [\n              {\n                text: 'Small (2.4″ - 6.2″)',\n                value: 'Small'\n              }, {\n                text: 'Medium (6.2″ - 6.5″)',\n                value: 'Medium'\n              },\n              {\n                text: 'Large (6.5″ - 8.0″)',\n                value: 'Large'\n              },\n            ]\n          }).then(res => {\n            this.addLog('human', this.last_action, res.text)\n            this.user_prefer.display_size = res.value\n            this.submitPreference()\n          })\n        })\n      })\n    },\n    ask_battery: function () {\n      this.last_action = 'ask_battery'\n      let msg = \"Okay.\"\n      if (this.identity_cue === '1') msg = \"Okay. I see the battery of the mobile phone is important to you.\"\n      this.bot(msg).then(() => {\n        this.bot(\" Which battery capacity are you looking for?\").then(() => {\n          botui.action.button({\n            addMessage: true,\n            human: true,\n            action: [\n              {\n                text: 'Small (1300mAh - 4000mAh)',\n                value: 'Small'\n              }, {\n                text: 'Medium (4000mAh - 4500mAh)',\n                value: 'Medium'\n              },\n              {\n                text: 'Large(4500mAh - 13000mAh)',\n                value: 'Large'\n              },\n            ]\n          }).then(res => {\n            this.addLog('human', this.last_action, res.text)\n            this.user_prefer.battery = res.value\n            this.submitPreference()\n          })\n        })\n      })\n    }\n    ,\n    ask_brand: function () {\n      this.last_action = 'ask_brand'\n      let msg = \"Okay.\"\n      if (this.identity_cue === '1') msg = \"Okay. I see the brand of the mobile phone is important to you.\"\n      this.bot(msg).then(() => {\n        this.bot(\" Which brand are you looking for?\").then(() => {\n          botui.action.button({\n            addMessage: true,\n            human: true,\n            action: [\n              {\n                text: 'Apple',\n                value: 'Apple'\n              }, {\n                text: 'Samsung',\n                value: 'Samsung'\n              },\n              {\n                text: 'Huawei',\n                value: 'Huawei'\n              },\n              {\n                text: 'Other',\n                value: 'Other'\n              },\n            ]\n          }).then(res => {\n            this.addLog('human', this.last_action, res.text)\n            this.user_prefer.brand = res.value\n            this.submitPreference()\n          })\n        })\n      })\n    }\n    ,\n    ask_weight: function () {\n      this.last_action = this.ask_weight\n      let msg = \"Okay.\"\n      if (this.identity_cue === '1') msg = \"Okay. I see the weight of the mobile phone is important to you.\"\n      this.bot(msg).then(() => {\n        this.bot(\" Which weight range are you looking for?\").then(() => {\n          botui.action.button({\n            addMessage: true,\n            human: true,\n            action: [\n              {\n                text: 'Light (117g-173g)',\n                value: 'Light'\n              }, {\n                text: 'Medium(173g-181g)',\n                value: 'Medium'\n              },\n              {\n                text: 'Heavy(181g-203g)',\n                value: 'Heavy'\n              },\n            ]\n          }).then(res => {\n            this.addLog('human', this.last_action, res.text)\n            this.user_prefer.weight = res.value\n            this.submitPreference()\n          })\n        })\n      })\n    }\n    ,\n\n//购物车部分\n    clickCart: function () {\n      this.show_cart = true\n    }\n    ,\n//跳到下一页\n    nextPage: function () {\n      instance.post('/chat/page2', {\n        'page2T': new Date().getTime(),\n        'cart': JSON.stringify(this.phone_in_cart),\n        'log': JSON.stringify(this.log),\n        'uuid': localStorage.getItem('uuid')\n      }).then((res) => {\n        console.log(res)\n        this.$router.replace('/que1').catch((err) => {\n          console.log(err.message)\n        });\n      })\n    }\n    ,\n  },\n  watch: {\n    exp_count: function () {\n      if (this.exp_count >= 3) {\n        this.explanation_style = '0'\n      }\n    }\n  },\n  computed: {\n    // 计算属性的 getter\n    cart_item_count: function () {\n      return this.phone_in_cart.length;\n    }\n  }\n}\n</script>\n<style>\n\n.explanation .botui-message-content.html {\n  background-color: #FFF0C5 !important;\n}\n</style>\n"]}]}